"use strict";$(function(){function e(){function e(){var e={center:w,zoom:14,minZoom:3,maxZoom:18,disableDefaultUI:!0};m=new google.maps.Map(document.getElementById("map-canvas"),e),f=new google.maps.InfoWindow({pixelOffset:new google.maps.Size(-23,-10)}),y=new google.maps.StyledMapType(B,{name:"Styled Map"}),m.mapTypes.set("map_style",y),m.setMapTypeId("map_style")}function n(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){w={lat:e.coords.latitude,lng:e.coords.longitude},m.setCenter(w),t(w)},function(){o(!0,f,m.getCenter())}):o(!1,f,m.getCenter())}function o(e,n,o){t(w)}function t(e){v.nearByPlaces([]);var n=new google.maps.places.PlacesService(m);n.nearbySearch({location:e,radius:v.radius(),types:k},a)}function a(e,n,o){{var t=new google.maps.LatLngBounds;document.getElementById("places")}if(n===google.maps.places.PlacesServiceStatus.OK){for(var a,s=0;a=e[s];s++)"political"!=a.types[a.types.length-1]&&(v.nearByPlaces.push(a),t.extend(a.geometry.location));i(v.nearByPlaces()),m.fitBounds(t),k=[]}}function s(){v.places([]);var e=document.getElementById("search-input"),n=new google.maps.places.SearchBox(e);m.addListener("bounds_changed",function(){n.setBounds(m.getBounds()),w=m.getCenter()}),n.addListener("places_changed",function(){v.places(n.getPlaces()),0!=v.places().length&&(1==v.places().length?t(v.places()[0].geometry.location):i(v.places()))}),k=[]}function i(e){document.getElementById("search-input").value="",v.keyword(""),v.markers().forEach(function(e){e.setMap(null)}),v.markers([]),h=new google.maps.LatLngBounds,e.forEach(function(e){var n={url:e.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)},o=new google.maps.Marker({map:m,icon:n,title:e.name,animation:google.maps.Animation.DROP,position:e.geometry.location});o.addListener("click",function(){v.markers().forEach(function(e){e.setAnimation(null)}),o.setAnimation(null!==o.getAnimation()?null:google.maps.Animation.BOUNCE)}),v.markers().push(o),google.maps.event.addListener(o,"click",function(){r(e,o)}),e.geometry.viewport?h.union(e.geometry.viewport):h.extend(e.geometry.location)}),m.fitBounds(h)}function r(e,n){var o=new google.maps.places.PlacesService(m);o.getDetails({placeId:e.place_id},function(e,o){o===google.maps.places.PlacesServiceStatus.OK&&(f.setContent('<div style="width: 200px;" class="longtext"><strong>'+e.name+"</strong><hr><span>"+e.formatted_address+'</span><br><span style="color: #4a81ab;">'+l(e)+'</span><br><br><div style="white-space: normal; max-height: 150; overflow-y: scroll;"><span>'+c(e)+'</span></div><br><span style="color: #df6d15;">'+p(e)+'</span><br><span id="infoLink">'+g(e)+'</span><br><div class="longtext"><a href="'+u(e)+'" target="_blank">'+u(e)+"<a></div>"+d(e)+"</div>"),f.open(m,n),document.getElementById("infoLink").addEventListener("click",function(){m.setZoom(18),m.panTo(n.position)}),document.getElementById("photoLink").addEventListener("click",function(){$("#photoViewer").show(),$("#close").click(function(){$("#photoViewer").hide()})}),v.placePhotos(e.photos),m.panTo(n.position))})}function l(e){return e.opening_hours?e.opening_hours.weekday_text[b.getDay()-1]:""}function c(e){return e.reviews?e.reviews[0].text:""}function p(e){return e.rating?e.rating:""}function g(e){return e.international_phone_number?e.international_phone_number:'<a href="#">'+e.geometry.location+"<a>"}function u(e){return e.website?e.website:""}function d(e){return e.photos&&e.photos.length>1?'<a id="photoLink" href="#"">photos<a>':'<div id="photoLink"></div>'}var m,f,h,y,v=this,w={lat:53.339821,lng:-6.2362889999999425},k=[],b=new Date;v.nearByPlaces=ko.observableArray([]),v.places=ko.observableArray([]),v.markers=ko.observableArray([]),v.radius=ko.observable(2e3),v.keyword=ko.observable(""),v.switchInfoBox=ko.observable(!0),v.listBoolean=ko.observable(!0),v.placePhotos=ko.observableArray([]),v.bydee=ko.observable(1),v.icons=ko.computed(function(){var e=new Set,n=[];for(var o in v.nearByPlaces())e.add(v.nearByPlaces()[o].icon);return e.forEach(function(e){n.push({icon:e})}),n}),v.displayedPlaces=function(){var e=[],n=v.keyword().toLowerCase(),o=[];if(o=v.places().length<2?v.nearByPlaces():v.places(),""!=v.keyword())for(var t in o)(-1!=o[t].name.toLowerCase().indexOf(n)||-1!=o[t].types[0].toLowerCase().indexOf(n))&&e.push(o[t]);else e=o;return e},v.formattedType=function(e){var n=e.types[0].replace(/[_-]/g," ");return n.charAt(0).toUpperCase()+n.substr(1,n.length)};var B=[];e(),n(),s(),v.clickMarker=function(e){var n=e.name.toLowerCase();v.markers().forEach(function(e){e.title.toLowerCase()===n&&(google.maps.event.trigger(e,"click"),m.panTo(e.position))})},$("#filters").on("click","button",function(){var e=$(this).children("img").attr("src").split("/"),n=e[e.length-1].split("-")[0];k=[],"fitness"==n&&k.push("gym");for(var o in googlePlaceTypes)-1!=googlePlaceTypes[o].toLowerCase().indexOf(n.substring(0,4))&&k.push(googlePlaceTypes[o]);t(m.getCenter())}),$("#reset").on("click",function(){k=[],t(m.getCenter())})}ko.applyBindings(new e),$("[group~=controls]").show(1e3),$("#hide").click(function(){var e="",n=$(this).children("span").attr("class");e="left"===n.slice(29)?n.replace("left","right"):n.replace("right","left"),$(this).siblings("div").animate({width:"toggle"},500),$(this).children("span").attr("class",e)})});